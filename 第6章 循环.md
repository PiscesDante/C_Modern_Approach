# 第6章 循环

循环是重复执行其他语句（循环体）的一种语句。C语言中，每个循环都有一个**控制表达式**。**每次执行循环体（循环重复一次）时都要对控制表达式求值**。如果表达式为真（即值不为零），那么继续执行循环。

C语言提供了三种重复语句，即while语句，do语句和for语句。

while循环在循环体之前测试控制表达式，do循环在至少执行一次循环体之后测试控制表达式，for语句则非常适合那些递增或者递减计数变量的循环。

## 6.1 while语句

`while (表达式) 语句`

执行while语句时，首先**计算控制表达式的值**。如果**值不为零**（即真值），那么**执行循环体**，接着**再次判定表达式**。这个过程（先判定控制表达式，再执行循环体）持续直到控制表达式的值为假才停止。

#### 无限循环

如果控制表达式的值始终非零，while语句将无法中止。

## 6.2 do语句

do语句的本质就是while语句，只不过其控制表达式是在每次循环体执行完毕之后才进行判定的。

格式：`do 语句 while (表达式);`

**必须给所有do语句都加上花括号**，这是因为没有花括号的do语句很容易被误认为时while语句。

## 6.3 for语句

for语句格式：`for (表达式1; 表达式2; 表达式3) 语句`

等价的while循环：

```C
表达式1;
while (表达式2) {
    语句
    表达式3;
}
```

**表达式1是循环开始执行前的初始化步骤，只执行一次；表达式2用来控制循环的终止（只要表达式2的值不为零，循环持续执行）；而表达式3是每次循环体执行完毕之后才执行的一个操作。**

### 6.3.1 for语句的惯用法

```C
for (i = 0; i < n; ++i) { ... } // 从0向上加到n-1
for (i = 1; i <= n; ++i) { ... } // 从1向上加到n
for (i = n - 1; i >= 0; --i) { ... } // 从n-1向下减到0
for (i = n; i > 0; --i) { ... } // 从n向下减到1
```

这里要当心循环次数差1的问题。

### 6.3.2 在for语句中省略表达式

for语句允许省去任意数量（0到3）的表达式。

如果省略第二个表达式，那么它的默认值为真，因此语句不会以靠机制停下来，必须借助return，break等语句。

### 6.3.3 C99中的for语句

在C99中，for语句的第一个表达式可以替换为一个声明，这一特性使得程序员可以声明一个只用于循环的的变量：

```C
for (int i = 0; i < n; ++i) { ... } // int i = 0方式为C99专属，循环变量i在循环外不可见
```

让for语句声明自己的循环控制变量通常是一个好办法：这样很方便且程序的可读性更强。

for语句语句可以声明多个变量，只要它们类型相同。

### 6.3.4 逗号运算符

`表达式1, 表达式2`

这里的表达式1和表达式2是两个任意的表达式。逗号表达式的计算要通过两步来实现：

1. 计算表达式1并且丢弃计算出来的值。
2. 计算表达式2，把这个值作为整个表达式的值。

这里对于表达式1的计算应该始终都会有副作用；如果没有，那么表达式1的存在是没有意义的。

提供**逗号运算符**是为了在C语言要求**只能有一个表达式的情况下可以使用两个或者多个表达式**。逗号运算符允许将两个表达式连接在一起构成一个表达式。

## 6.4 退出循环

* continue语句：跳过某次迭代的部分内容，但是不会跳出整个循环。
* goto语句：允许程序从一条语句跳转到另一条语句。

### 6.4.1 break语句

对于退出点在循环体的中间而不是循环体之前或者之后的情况，break语句特别有用。

break语句把程序控制从包含该语句的最内层while、do、for或者switch语句中转移出来。**因此，当这些语句出现嵌套时，break语句只能跳出一层嵌套**。

### 6.4.2 continue语句

break语句是把程序控制转移到循环体末尾之后，而continue语句是把程序控制转移到循环体末尾之前。

break和continue的一个区别是：break语句可以用于switch语句和循环，而continue只能用于循环。

### 6.4.3 goto语句

goto语句可以跳转到函数中任何有标号的语句处。（C99中增加了一条限制：goto语句不可以用于绕过变成数组的声明。）

标号只是放置在语句开始处的标识符：`标识符 : 语句`

goto语句的自身格式如下：`goto : 标识符;`

**goto语句可以跳出多重循环嵌套的语句群**。

## 6.5 空语句

语句可以为空，就是除了末尾处的分号以外什么符号也没有。

空语句的主要作用之一就是编写空的循环体。

